<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Google Analytics (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-B74HV76Z16"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-B74HV76Z16');
    </script>

    <!-- ê¸°ë³¸ ë©”íƒ€ íƒœê·¸ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- í˜ì´ì§€ ì •ë³´ -->
    <title>DeepMirror | ë¶„ì„ ê²°ê³¼ ë¦¬í¬íŠ¸</title>
    <meta name="description" content="Big Five ì„±ê²© ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”. AIê°€ ë¶„ì„í•œ ë‹¹ì‹ ì˜ ì„±ê²© íŠ¹ì„±ê³¼ ì„¸ë¶€ ì ìˆ˜ë¥¼ ì‹œê°í™”ëœ ì°¨íŠ¸ë¡œ ì œê³µí•©ë‹ˆë‹¤.">
    <meta name="keywords" content="ì„±ê²© ë¶„ì„ ê²°ê³¼, Big Five ë¦¬í¬íŠ¸, ì„±ê²© ì§„ë‹¨ ê²°ê³¼, IPIP ì ìˆ˜, AI ì„±ê²© ë¶„ì„, ì‹¬ë¦¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼">
    <meta name="author" content="DeepMirror Team">

    <!-- íŒŒë¹„ì½˜ -->
    <link rel="icon" href="/images/favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="/images/favicon.png">

    <!-- Open Graph ë©”íƒ€ íƒœê·¸ (ì†Œì…œ ê³µìœ ìš©) -->
    <meta property="og:type" content="website">
    <meta property="og:title" th:content="'DeepMirror: ' + ${result.nickname} + 'ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼'">
    <meta property="og:description" content="ë‚˜ì˜ ì„±ê²© ìœ í˜•ê³¼ ìƒì„¸ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/6366f1/ffffff?text=DeepMirror+Result">
    <meta property="og:url" th:content="'http://localhost:8080/results/' + ${result.id}">

    <!-- ì™¸ë¶€ ìŠ¤íƒ€ì¼ì‹œíŠ¸ ë° ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen py-8 px-4">
    <div class="max-w-6xl mx-auto">
        <!-- Header Section -->
        <header class="bg-white rounded-2xl shadow-2xl p-8 mb-6">
            <div class="text-center">
                <div class="inline-block bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full p-3 mb-4">
                    <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
                <h1 class="text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2" th:text="${result.nickname} + 'ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼'">
                    000ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼
                </h1>
                <p class="text-sm text-gray-500 mt-2" th:text="${#temporals.format(result.createdAt, 'yyyyë…„ MMì›” ddì¼ HH:mm:ss')}">ë¶„ì„ ì™„ë£Œ ì¼ì‹œ</p>
            </div>
        </header>

        <!-- Main Content: Chart + AI Analysis -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Radar Chart Card -->
            <article class="bg-white rounded-2xl shadow-2xl p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ì„±ê²© íŠ¹ì„± ë¶„í¬</h2>
                <div class="relative" style="height: 400px;">
                    <canvas id="personalityRadarChart"></canvas>
                </div>

                <!-- Legend with scores -->
                <div class="mt-6 space-y-3">
                    <div class="flex justify-between items-center px-4 py-2 bg-indigo-50 rounded-lg">
                        <span class="text-sm font-semibold text-indigo-700">ê°œë°©ì„±</span>
                        <span class="text-lg font-bold text-indigo-600" th:text="${result.openness} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-blue-50 rounded-lg">
                        <span class="text-sm font-semibold text-blue-700">ì„±ì‹¤ì„±</span>
                        <span class="text-lg font-bold text-blue-600" th:text="${result.conscientiousness} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-purple-50 rounded-lg">
                        <span class="text-sm font-semibold text-purple-700">ì™¸í–¥ì„±</span>
                        <span class="text-lg font-bold text-purple-600" th:text="${result.extraversion} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-pink-50 rounded-lg">
                        <span class="text-sm font-semibold text-pink-700">ì¹œí™”ì„±</span>
                        <span class="text-lg font-bold text-pink-600" th:text="${result.agreeableness} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-violet-50 rounded-lg">
                        <span class="text-sm font-semibold text-violet-700">ì‹ ê²½ì„±</span>
                        <span class="text-lg font-bold text-violet-600" th:text="${result.neuroticism} + 'ì '">0ì </span>
                    </div>
                </div>
            </article>

            <!-- AI Analysis Card -->
            <article class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-2xl p-8 text-white">
                <h2 class="text-2xl font-bold mb-4 flex items-center">
                    <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                    AI ì„±ê²© ë¶„ì„
                </h2>
                <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-xl p-6 overflow-y-auto" style="max-height: 550px;">
                    <p class="text-base leading-relaxed whitespace-pre-wrap" th:text="${result.aiAnalysis}">
                        AIê°€ ë¶„ì„í•œ ë‹¹ì‹ ì˜ ì„±ê²©ì— ëŒ€í•œ ìƒì„¸í•œ ì„¤ëª…ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                </div>
            </article>
        </section>

        <!-- Integrated Personality Analysis Section -->
        <section class="bg-white rounded-2xl shadow-2xl p-8 mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-3 text-center">í†µí•© ì„±ê²© ë¶„ì„</h2>
                <p class="text-center text-gray-600 mb-8">ê° ì„±ê²© íŠ¹ì„±ì˜ ì„¸ë¶€ ì ìˆ˜ì™€ ì†Œë¶„ë¥˜ ì°¨íŠ¸ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>

            <!-- Integrated Cards Container -->
            <div id="integratedAnalysisContainer" class="space-y-8">
                <!-- Cards will be dynamically generated by JavaScript -->
            </div>
        </section>

        <!-- Action Buttons -->
        <section class="bg-white rounded-2xl shadow-2xl p-6 mb-6">
            <div class="flex flex-col sm:flex-row gap-4">
                <a href="/"
                   class="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-xl transition duration-200 transform hover:scale-105 shadow-lg text-center">
                    ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°
                </a>
                <button onclick="window.print()"
                        class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-4 px-6 rounded-xl transition duration-200 transform hover:scale-105 shadow-lg">
                    ê²°ê³¼ ì¸ì‡„
                </button>
            </div>
        </section>

        <!-- Share Button -->
        <section class="bg-white rounded-2xl shadow-2xl p-6 mb-6">
            <button onclick="shareResult()"
                    class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-5 px-6 rounded-xl transition duration-200 transform hover:scale-105 shadow-lg flex items-center justify-center gap-3">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                </svg>
                <span class="text-lg">ê²°ê³¼ ê³µìœ í•˜ê¸° ğŸ“¤</span>
            </button>
        </section>

        <!-- Toast Message (Hidden by default) -->
        <div id="toast" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-6 py-4 rounded-xl shadow-2xl opacity-0 transition-opacity duration-300 pointer-events-none z-50">
            <div class="flex items-center gap-3">
                <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="font-semibold">ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤</span>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        // ========================================
        // [Data Layer] - Thymeleaf ë°ì´í„° ë¡œë”©
        // ========================================

        const USER_DATA = {
            nickname: /*[[${result.nickname}]]*/ 'ì‚¬ìš©ì',
            createdAt: /*[[${result.createdAt}]]*/ null
        };

        const SCORES = {
            openness: /*[[${result.openness}]]*/ 0,
            conscientiousness: /*[[${result.conscientiousness}]]*/ 0,
            extraversion: /*[[${result.extraversion}]]*/ 0,
            agreeableness: /*[[${result.agreeableness}]]*/ 0,
            neuroticism: /*[[${result.neuroticism}]]*/ 0
        };

        const DETAIL_SCORES = /*[[${detailMap}]]*/ {};

        const FACET_NAMES = {
            'N': ['ë¶ˆì•ˆ', 'ë¶„ë…¸', 'ìš°ìš¸', 'ìì˜ì‹', 'ì¶©ë™ì„±', 'ì·¨ì•½ì„±'],
            'E': ['ì¹œë°€ê°', 'ì‚¬êµì„±', 'ë¦¬ë”ì‹­', 'í™œë™ì„±', 'ìê·¹ì¶”êµ¬', 'ê¸ì •ì •ì„œ'],
            'O': ['ìƒìƒë ¥', 'ì˜ˆìˆ ì ê°ìˆ˜ì„±', 'ê°ì„±', 'ëª¨í—˜ì„±', 'ì§€ì í˜¸ê¸°ì‹¬', 'ê°€ì¹˜ê´€'],
            'A': ['ì‹ ë¢°', 'ë„ë•ì„±', 'ì´íƒ€ì£¼ì˜', 'í˜‘ë ¥', 'ê²¸ì†', 'ê³µê°'],
            'C': ['ìê¸°íš¨ëŠ¥ê°', 'ì§ˆì„œ', 'ì˜ë¬´ê°', 'ì„±ì·¨ì§€í–¥', 'ì ˆì œ', 'ì‹ ì¤‘í•¨']
        };

        const TRAIT_DESCRIPTIONS = {
            openness: {
                name: 'ê°œë°©ì„±',
                nameEn: 'Openness',
                subtitle: 'ìƒˆë¡œìš´ ê²½í—˜ê³¼ ì•„ì´ë””ì–´ì— ëŒ€í•œ ê°œë°©ì„±',
                high: 'ë‹¹ì‹ ì€ ìƒìƒë ¥ì´ í’ë¶€í•˜ê³  í˜¸ê¸°ì‹¬ì´ ë§ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ê²½í—˜ê³¼ ì•„ì´ë””ì–´ë¥¼ ì ê·¹ì ìœ¼ë¡œ íƒêµ¬í•˜ë©°, ì˜ˆìˆ ì ì´ê³  ì°½ì˜ì ì¸ í™œë™ì„ ì¦ê¹ë‹ˆë‹¤. ê´€ìŠµì— ì–½ë§¤ì´ì§€ ì•Šê³  ë…ì°½ì ì¸ ì‚¬ê³ ë¥¼ ì„ í˜¸í•˜ë©°, ë³€í™”ì™€ ë‹¤ì–‘ì„±ì„ í™˜ì˜í•©ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ìƒˆë¡œìš´ ê²ƒì— ëŒ€í•œ í˜¸ê¸°ì‹¬ê³¼ ìµìˆ™í•œ ê²ƒì— ëŒ€í•œ ì„ í˜¸ ì‚¬ì´ì—ì„œ ê· í˜•ì„ ìœ ì§€í•©ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ ì°½ì˜ì ì¸ ì ‘ê·¼ì„ ì‹œë„í•˜ê¸°ë„ í•˜ê³ , ê²€ì¦ëœ ë°©ë²•ì„ ë”°ë¥´ê¸°ë„ í•©ë‹ˆë‹¤. ì ì ˆí•œ ìˆ˜ì¤€ì˜ ë³€í™”ë¥¼ ë°›ì•„ë“¤ì´ëŠ” í¸ì…ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ìµìˆ™í•˜ê³  ê²€ì¦ëœ ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì „í†µì ì´ê³  ì‹¤ìš©ì ì¸ ì ‘ê·¼ ë°©ì‹ì„ ì„ í˜¸í•˜ë©°, ê¸‰ê²©í•œ ë³€í™”ë³´ë‹¤ëŠ” ì•ˆì •ì„±ì„ ì¤‘ìš”í•˜ê²Œ ì—¬ê¹ë‹ˆë‹¤. êµ¬ì²´ì ì´ê³  í˜„ì‹¤ì ì¸ ê²ƒì— ë” ê´€ì‹¬ì´ ë§ìœ¼ë©°, ì˜ˆì¸¡ ê°€ëŠ¥í•œ í™˜ê²½ì„ í¸ì•ˆí•˜ê²Œ ëŠë‚ë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-indigo-50 to-indigo-100',
                    border: 'border-indigo-200',
                    titleText: 'text-indigo-700',
                    badgeBg: 'bg-indigo-100',
                    badgeText: 'text-indigo-800',
                    progressBar: 'bg-gradient-to-r from-indigo-400 to-indigo-600',
                    chartBg: 'rgba(99, 102, 241, 0.2)',
                    chartBorder: 'rgba(99, 102, 241, 1)',
                    chartPoint: 'rgba(99, 102, 241, 1)',
                    chartGrid: 'rgba(99, 102, 241, 0.2)',
                    chartTooltip: 'rgba(99, 102, 241, 0.9)'
                },
                facetKey: 'O'
            },
            conscientiousness: {
                name: 'ì„±ì‹¤ì„±',
                nameEn: 'Conscientiousness',
                subtitle: 'ì±…ì„ê°ê³¼ ì¡°ì§í™” ëŠ¥ë ¥',
                high: 'ë‹¹ì‹ ì€ ë§¤ìš° ì²´ê³„ì ì´ê³  ì±…ì„ê°ì´ ê°•í•©ë‹ˆë‹¤. ê³„íšì„ ì„¸ìš°ê³  ëª©í‘œë¥¼ í–¥í•´ ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ë©°, ì„¸ë¶€ì‚¬í•­ì— ì£¼ì˜ë¥¼ ê¸°ìš¸ì…ë‹ˆë‹¤. ì‹œê°„ ê´€ë¦¬ë¥¼ ì˜í•˜ê³  ì•½ì†ì„ ì¤‘ìš”í•˜ê²Œ ì—¬ê¸°ë©°, ì¼ì„ ì™„ë²½í•˜ê²Œ ë§ˆë¬´ë¦¬í•˜ë ¤ê³  ë…¸ë ¥í•©ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ìƒí™©ì— ë”°ë¼ ì²´ê³„ì ìœ¼ë¡œ ì¼í•˜ê¸°ë„ í•˜ê³  ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•˜ê¸°ë„ í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ì¼ì—ëŠ” ê³„íšì ìœ¼ë¡œ ì ‘ê·¼í•˜ì§€ë§Œ, ë•Œë¡œëŠ” ì¦‰í¥ì ì¸ ë©´ëª¨ë„ ë³´ì…ë‹ˆë‹¤. ì±…ì„ê°ê³¼ ììœ ë¡œì›€ ì‚¬ì´ì—ì„œ ê· í˜•ì„ ì°¾ìœ¼ë ¤ í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ìë°œì ì´ê³  ìœ ì—°í•œ í¸ì…ë‹ˆë‹¤. ì—„ê²©í•œ ê³„íšë³´ë‹¤ëŠ” ìƒí™©ì— ë”°ë¼ ì¦‰í¥ì ìœ¼ë¡œ ëŒ€ì‘í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ìœµí†µì„± ìˆê²Œ ì¼ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ììœ ë¡œìš´ í™˜ê²½ì—ì„œ ë” í¸ì•ˆí•¨ì„ ëŠë¼ë©°, ì§€ë‚˜ì¹œ ê·œì¹™ì´ë‚˜ ì ˆì°¨ë¥¼ ë¶€ë‹´ìŠ¤ëŸ¬ì›Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-blue-50 to-blue-100',
                    border: 'border-blue-200',
                    titleText: 'text-blue-700',
                    badgeBg: 'bg-blue-100',
                    badgeText: 'text-blue-800',
                    progressBar: 'bg-gradient-to-r from-blue-400 to-blue-600',
                    chartBg: 'rgba(59, 130, 246, 0.2)',
                    chartBorder: 'rgba(59, 130, 246, 1)',
                    chartPoint: 'rgba(59, 130, 246, 1)',
                    chartGrid: 'rgba(59, 130, 246, 0.2)',
                    chartTooltip: 'rgba(59, 130, 246, 0.9)'
                },
                facetKey: 'C'
            },
            extraversion: {
                name: 'ì™¸í–¥ì„±',
                nameEn: 'Extraversion',
                subtitle: 'ì‚¬íšŒì  ìƒí˜¸ì‘ìš©ê³¼ ì—ë„ˆì§€',
                high: 'ë‹¹ì‹ ì€ í™œë°œí•˜ê³  ì‚¬êµì ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ìˆì„ ë•Œ ì—ë„ˆì§€ë¥¼ ì–»ìœ¼ë©°, ì£¼ëª©ë°›ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ ëŒ€í™”ì— ì°¸ì—¬í•˜ê³ , ìƒˆë¡œìš´ ì‚¬ëŒë“¤ì„ ë§Œë‚˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì—´ì •ì ì´ê³  ë‚™ê´€ì ì¸ íƒœë„ë¡œ ì£¼ë³€ì„ ë°ê²Œ ë§Œë“­ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ì‚¬íšŒì  ìƒí™©ê³¼ í˜¼ìë§Œì˜ ì‹œê°„ ëª¨ë‘ë¥¼ ì¦ê¹ë‹ˆë‹¤. ë•Œë¡œëŠ” ì‚¬êµì ì´ê³  í™œë°œí•˜ì§€ë§Œ, í˜¼ì ìˆëŠ” ì‹œê°„ë„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ ì™¸í–¥ì ì´ê±°ë‚˜ ë‚´í–¥ì ì¸ ë©´ëª¨ë¥¼ ë³´ì´ë©°, ë‹¤ì–‘í•œ í™˜ê²½ì— ì˜ ì ì‘í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ì¡°ìš©í•˜ê³  ì‚¬ë ¤ ê¹Šì€ í¸ì…ë‹ˆë‹¤. í˜¼ìë§Œì˜ ì‹œê°„ì´ë‚˜ ì†Œìˆ˜ì˜ ì¹œí•œ ì‚¬ëŒë“¤ê³¼ ë³´ë‚´ëŠ” ì‹œê°„ì„ ì„ í˜¸í•˜ë©°, ê¹Šì´ ìˆëŠ” ëŒ€í™”ë¥¼ ì¢‹ì•„í•©ë‹ˆë‹¤. í° ëª¨ì„ë³´ë‹¤ëŠ” ì¡°ìš©í•œ í™˜ê²½ì„ í¸ì•ˆí•˜ê²Œ ëŠë¼ë©°, ì‹ ì¤‘í•˜ê²Œ ìƒê°í•œ í›„ í–‰ë™í•©ë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-purple-50 to-purple-100',
                    border: 'border-purple-200',
                    titleText: 'text-purple-700',
                    badgeBg: 'bg-purple-100',
                    badgeText: 'text-purple-800',
                    progressBar: 'bg-gradient-to-r from-purple-400 to-purple-600',
                    chartBg: 'rgba(168, 85, 247, 0.2)',
                    chartBorder: 'rgba(168, 85, 247, 1)',
                    chartPoint: 'rgba(168, 85, 247, 1)',
                    chartGrid: 'rgba(168, 85, 247, 0.2)',
                    chartTooltip: 'rgba(168, 85, 247, 0.9)'
                },
                facetKey: 'E'
            },
            agreeableness: {
                name: 'ì¹œí™”ì„±',
                nameEn: 'Agreeableness',
                subtitle: 'íƒ€ì¸ì— ëŒ€í•œ ê³µê°ê³¼ í˜‘ë ¥',
                high: 'ë‹¹ì‹ ì€ ë”°ëœ»í•˜ê³  ì¹œì ˆí•˜ë©° í˜‘ì¡°ì ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì— ê³µê°ì„ ì˜í•˜ê³ , íƒ€ì¸ì„ ë„ìš°ë ¤ëŠ” ë§ˆìŒì´ ê°•í•©ë‹ˆë‹¤. ê°ˆë“±ì„ í”¼í•˜ê³  ì¡°í™”ë¥¼ ì¶”êµ¬í•˜ë©°, íƒ€ì¸ì˜ ê´€ì ì„ ì´í•´í•˜ê³  ì¡´ì¤‘í•©ë‹ˆë‹¤. ê´€ëŒ€í•˜ê³  ë„ˆê·¸ëŸ¬ìš´ ì„±ê²©ì…ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ í˜‘ì¡°ì ì´ë©´ì„œë„ ìì‹ ì˜ ì˜ê²¬ì„ í‘œí˜„í•  ì¤„ ì••ë‹ˆë‹¤. íƒ€ì¸ì„ ë°°ë ¤í•˜ì§€ë§Œ í•„ìš”í•  ë•ŒëŠ” ë‹¨í˜¸í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê°ê³¼ ê°ê´€ì„± ì‚¬ì´ì—ì„œ ê· í˜•ì„ ìœ ì§€í•˜ë©°, ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ë…ë¦½ì ì´ê³  ê²½ìŸì ì…ë‹ˆë‹¤. ê°ê´€ì ì´ê³  ë…¼ë¦¬ì ì¸ ì ‘ê·¼ì„ ì„ í˜¸í•˜ë©°, ìì‹ ì˜ ì˜ê²¬ì„ ì†”ì§í•˜ê²Œ í‘œí˜„í•©ë‹ˆë‹¤. ë•Œë¡œëŠ” íƒ€ì¸ì˜ ê°ì •ë³´ë‹¤ ì‚¬ì‹¤ê³¼ íš¨ìœ¨ì„±ì„ ìš°ì„ ì‹œí•˜ë©°, í•„ìš”í•  ë•ŒëŠ” ê°ˆë“±ì„ ë§ˆë‹¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-pink-50 to-pink-100',
                    border: 'border-pink-200',
                    titleText: 'text-pink-700',
                    badgeBg: 'bg-pink-100',
                    badgeText: 'text-pink-800',
                    progressBar: 'bg-gradient-to-r from-pink-400 to-pink-600',
                    chartBg: 'rgba(236, 72, 153, 0.2)',
                    chartBorder: 'rgba(236, 72, 153, 1)',
                    chartPoint: 'rgba(236, 72, 153, 1)',
                    chartGrid: 'rgba(236, 72, 153, 0.2)',
                    chartTooltip: 'rgba(236, 72, 153, 0.9)'
                },
                facetKey: 'A'
            },
            neuroticism: {
                name: 'ì‹ ê²½ì„±',
                nameEn: 'Neuroticism',
                subtitle: 'ì •ì„œì  ì•ˆì •ì„±ê³¼ ìŠ¤íŠ¸ë ˆìŠ¤ ëŒ€ì²˜',
                high: 'ë‹¹ì‹ ì€ ê°ì •ì´ í’ë¶€í•˜ê³  ì„¬ì„¸í•©ë‹ˆë‹¤. ìŠ¤íŠ¸ë ˆìŠ¤ë‚˜ ê±±ì •ì„ ìì£¼ ê²½í—˜í•  ìˆ˜ ìˆìœ¼ë©°, ê°ì • ë³€í™”ê°€ í¬ê³  ë¯¼ê°í•œ í¸ì…ë‹ˆë‹¤. ì–´ë ¤ìš´ ìƒí™©ì—ì„œ ë¶ˆì•ˆì´ë‚˜ ê¸´ì¥ì„ ëŠë¼ê¸° ì‰½ì§€ë§Œ, ì´ëŠ” ì‹ ì¤‘í•˜ê³  ì„¸ì‹¬í•œ ì ‘ê·¼ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ì •ì„œì ìœ¼ë¡œ ì•ˆì •ì ì´ë©´ì„œë„ ë•Œë•Œë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ëŠë‚ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ìƒí™©ì—ì„œ ì¹¨ì°©í•˜ê²Œ ëŒ€ì‘í•˜ì§€ë§Œ, ì–´ë ¤ìš´ ìƒí™©ì—ì„œëŠ” ë¶ˆì•ˆì„ ê²½í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ì •ê³¼ ì´ì„± ì‚¬ì´ì—ì„œ ê· í˜•ì„ ìœ ì§€í•˜ë ¤ ë…¸ë ¥í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ì •ì„œì ìœ¼ë¡œ ë§¤ìš° ì•ˆì •ì ì…ë‹ˆë‹¤. ìŠ¤íŠ¸ë ˆìŠ¤ ìƒí™©ì—ì„œë„ ì¹¨ì°©í•¨ì„ ìœ ì§€í•˜ë©°, ê°ì •ì ìœ¼ë¡œ í”ë“¤ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. ì°¨ë¶„í•˜ê³  í‰ì˜¨í•œ ìƒíƒœë¥¼ ìœ ì§€í•˜ë©°, ì–´ë ¤ìš´ ìƒí™©ì—ì„œë„ ëƒ‰ì •í•˜ê²Œ ëŒ€ì²˜í•©ë‹ˆë‹¤. ìì‹ ê° ìˆê³  íšŒë³µíƒ„ë ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-violet-50 to-violet-100',
                    border: 'border-violet-200',
                    titleText: 'text-violet-700',
                    badgeBg: 'bg-violet-100',
                    badgeText: 'text-violet-800',
                    progressBar: 'bg-gradient-to-r from-violet-400 to-violet-600',
                    chartBg: 'rgba(139, 92, 246, 0.2)',
                    chartBorder: 'rgba(139, 92, 246, 1)',
                    chartPoint: 'rgba(139, 92, 246, 1)',
                    chartGrid: 'rgba(139, 92, 246, 0.2)',
                    chartTooltip: 'rgba(139, 92, 246, 0.9)'
                },
                facetKey: 'N'
            }
        };

        // ========================================
        // [Chart Configuration] - Chart.js ì „ì—­ ì„¤ì •
        // ========================================

        const CHART_DEFAULTS = {
            animation: {
                duration: 1200,
                easing: 'easeInOutQuart'
            },
            responsive: true,
            maintainAspectRatio: false
        };

        const RADAR_SCALE_CONFIG = {
            min: 0,
            max: 100,
            beginAtZero: true,
            ticks: {
                stepSize: 20,
                backdropColor: 'rgba(255, 255, 255, 0.8)'
            }
        };

        // ========================================
        // [Chart Engine] - ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì°¨íŠ¸ ìƒì„± í•¨ìˆ˜
        // ========================================

        /**
         * Radar ì°¨íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ê³µí†µ í•¨ìˆ˜
         * @param {string} canvasId - ìº”ë²„ìŠ¤ ì—˜ë¦¬ë¨¼íŠ¸ ID
         * @param {string} label - ë°ì´í„°ì…‹ ë ˆì´ë¸”
         * @param {Array} labels - ì°¨íŠ¸ ë ˆì´ë¸” ë°°ì—´
         * @param {Array} data - ì°¨íŠ¸ ë°ì´í„° ë°°ì—´
         * @param {Object} colors - ìƒ‰ìƒ ì„¤ì • ê°ì²´
         * @param {Object} customOptions - ì¶”ê°€ ì˜µì…˜ (ì„ íƒì‚¬í•­)
         * @returns {Chart} Chart.js ì¸ìŠ¤í„´ìŠ¤
         */
        function createRadarChart(canvasId, label, labels, data, colors, customOptions = {}) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) {
                console.error(`Canvas element with id "${canvasId}" not found`);
                return null;
            }

            const ctx = canvas.getContext('2d');
            const fontSize = customOptions.fontSize || { point: 11, tick: 10 };

            return new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        backgroundColor: colors.bg,
                        borderColor: colors.border,
                        borderWidth: customOptions.borderWidth || 2,
                        pointBackgroundColor: colors.point,
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: colors.point,
                        pointRadius: customOptions.pointRadius || 4,
                        pointHoverRadius: customOptions.pointHoverRadius || 6
                    }]
                },
                options: {
                    ...CHART_DEFAULTS,
                    scales: {
                        r: {
                            ...RADAR_SCALE_CONFIG,
                            ticks: {
                                ...RADAR_SCALE_CONFIG.ticks,
                                font: { size: fontSize.tick }
                            },
                            pointLabels: {
                                font: {
                                    size: fontSize.point,
                                    weight: 'bold'
                                },
                                color: '#4B5563',
                                padding: 8
                            },
                            grid: {
                                color: colors.grid
                            },
                            angleLines: {
                                color: colors.grid
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: customOptions.showLegend || false
                        },
                        tooltip: {
                            backgroundColor: colors.tooltip,
                            padding: 10,
                            titleFont: {
                                size: 12,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 11
                            },
                            callbacks: {
                                label: function(context) {
                                    return ' ' + context.parsed.r + 'ì ';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ========================================
        // [UI Utilities] - ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        // ========================================

        function getLevel(score) {
            if (score >= 67) return 'high';
            if (score >= 34) return 'middle';
            return 'low';
        }

        function getLevelBadge(score) {
            if (score >= 67) return 'ë†’ìŒ';
            if (score >= 34) return 'ë³´í†µ';
            return 'ë‚®ìŒ';
        }

        function getLevelBadgeColor(score) {
            if (score >= 67) return 'bg-green-100 text-green-800';
            if (score >= 34) return 'bg-yellow-100 text-yellow-800';
            return 'bg-gray-100 text-gray-800';
        }

        function getFacetData(facetKey) {
            if (!DETAIL_SCORES || Object.keys(DETAIL_SCORES).length === 0) {
                console.warn('DETAIL_SCORES is empty or null');
                return [0, 0, 0, 0, 0, 0];
            }

            return [
                DETAIL_SCORES[facetKey + '1'] || 0,
                DETAIL_SCORES[facetKey + '2'] || 0,
                DETAIL_SCORES[facetKey + '3'] || 0,
                DETAIL_SCORES[facetKey + '4'] || 0,
                DETAIL_SCORES[facetKey + '5'] || 0,
                DETAIL_SCORES[facetKey + '6'] || 0
            ];
        }

        // ========================================
        // [Share Logic] - ê³µìœ  ë° í† ìŠ¤íŠ¸ ê¸°ëŠ¥
        // ========================================

        async function shareResult() {
            const shareData = {
                title: 'DeepMirror: ' + USER_DATA.nickname + 'ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼',
                text: 'ë‚˜ì˜ ì„±ê²© ìœ í˜•ê³¼ ìƒì„¸ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!',
                url: window.location.href
            };

            try {
                if (navigator.share) {
                    await navigator.share(shareData);
                } else {
                    await copyToClipboard(window.location.href);
                    showToast();
                }
            } catch (error) {
                if (error.name !== 'AbortError') {
                    console.error('ê³µìœ  ì‹¤íŒ¨:', error);
                    try {
                        await copyToClipboard(window.location.href);
                        showToast();
                    } catch (clipboardError) {
                        console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', clipboardError);
                        alert('ê³µìœ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ê³µìœ  ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    }
                }
            }
        }

        async function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                await navigator.clipboard.writeText(text);
            } else {
                throw new Error('Clipboard API not supported');
            }
        }

        function showToast() {
            const toast = document.getElementById('toast');
            if (!toast) return;

            toast.style.opacity = '1';
            toast.style.pointerEvents = 'auto';

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.pointerEvents = 'none';
            }, 3000);
        }

        // ========================================
        // [Rendering Logic] - ì°¨íŠ¸ ë° UI ë Œë”ë§
        // ========================================

        function createIntegratedFacetChart(canvasId, facetKey, colorConfig) {
            const facetData = getFacetData(facetKey);
            const labels = FACET_NAMES[facetKey];

            if (!labels) {
                console.error(`Unknown facet key: ${facetKey}`);
                return null;
            }

            const colors = {
                bg: colorConfig.chartBg,
                border: colorConfig.chartBorder,
                point: colorConfig.chartPoint,
                grid: colorConfig.chartGrid,
                tooltip: colorConfig.chartTooltip
            };

            return createRadarChart(
                canvasId,
                'ì†Œë¶„ë¥˜ ì ìˆ˜',
                labels,
                facetData,
                colors,
                {
                    fontSize: { point: 11, tick: 10 },
                    borderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }
            );
        }

        function renderIntegratedAnalysis() {
            const container = document.getElementById('integratedAnalysisContainer');
            if (!container) {
                console.error('integratedAnalysisContainer not found');
                return;
            }

            const traits = [
                { key: 'openness', score: SCORES.openness },
                { key: 'conscientiousness', score: SCORES.conscientiousness },
                { key: 'extraversion', score: SCORES.extraversion },
                { key: 'agreeableness', score: SCORES.agreeableness },
                { key: 'neuroticism', score: SCORES.neuroticism }
            ];

            traits.forEach((trait) => {
                const data = TRAIT_DESCRIPTIONS[trait.key];
                const level = getLevel(trait.score);
                const description = data[level];
                const colors = data.colors;
                const canvasId = `facetChart_${trait.key}`;

                const card = document.createElement('article');
                card.className = `${colors.cardBg} border-2 ${colors.border} rounded-2xl shadow-xl overflow-hidden`;

                card.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-8">
                        <!-- ì¢Œì¸¡: Facet ì°¨íŠ¸ ì˜ì—­ -->
                        <div class="flex flex-col justify-center">
                            <h3 class="${colors.titleText} text-2xl font-bold mb-2 text-center">${data.name}</h3>
                            <p class="text-sm text-gray-600 mb-4 text-center">${data.nameEn}</p>
                            <div class="relative bg-white rounded-xl p-4 shadow-inner" style="max-height: 320px; height: 320px;">
                                <canvas id="${canvasId}"></canvas>
                            </div>
                        </div>

                        <!-- ìš°ì¸¡: ì„¸ë¶€ ì •ë³´ ì˜ì—­ -->
                        <div class="flex flex-col justify-center">
                            <div class="mb-6">
                                <div class="flex justify-between items-center mb-3">
                                    <div>
                                        <h4 class="${colors.titleText} text-xl font-bold">${data.subtitle}</h4>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="${getLevelBadgeColor(trait.score)} px-3 py-1 rounded-full text-xs font-semibold">
                                            ${getLevelBadge(trait.score)}
                                        </span>
                                        <span class="${colors.titleText} text-4xl font-bold">${trait.score}</span>
                                    </div>
                                </div>

                                <!-- Progress Bar -->
                                <div class="w-full bg-white bg-opacity-60 rounded-full h-4 overflow-hidden shadow-inner mb-4">
                                    <div class="${colors.progressBar} h-4 rounded-full transition-all duration-1000 ease-out shadow-md"
                                         style="width: 0%"
                                         data-width="${trait.score}%">
                                    </div>
                                </div>
                            </div>

                            <!-- ìƒì„¸ ì„¤ëª… -->
                            <div class="bg-white bg-opacity-50 rounded-xl p-5 shadow-sm">
                                <p class="text-gray-800 leading-relaxed text-sm">
                                    ${description}
                                </p>
                            </div>
                        </div>
                    </div>
                `;

                container.appendChild(card);

                setTimeout(() => {
                    createIntegratedFacetChart(canvasId, data.facetKey, colors);
                }, 50);
            });

            setTimeout(() => {
                document.querySelectorAll('[data-width]').forEach(bar => {
                    bar.style.width = bar.getAttribute('data-width');
                });
            }, 100);
        }

        function renderMainRadarChart() {
            const labels = ['ê°œë°©ì„±', 'ì„±ì‹¤ì„±', 'ì™¸í–¥ì„±', 'ì¹œí™”ì„±', 'ì‹ ê²½ì„±'];
            const data = [
                SCORES.openness,
                SCORES.conscientiousness,
                SCORES.extraversion,
                SCORES.agreeableness,
                SCORES.neuroticism
            ];

            const colors = {
                bg: 'rgba(99, 102, 241, 0.3)',
                border: 'rgba(99, 102, 241, 1)',
                point: 'rgba(139, 92, 246, 1)',
                grid: 'rgba(99, 102, 241, 0.2)',
                tooltip: 'rgba(99, 102, 241, 0.9)'
            };

            return createRadarChart(
                'personalityRadarChart',
                'ì„±ê²© íŠ¹ì„± ì ìˆ˜',
                labels,
                data,
                colors,
                {
                    fontSize: { point: 14, tick: 12 },
                    borderWidth: 3,
                    pointRadius: 5,
                    pointHoverRadius: 7
                }
            );
        }

        // ========================================
        // [Initialization] - í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        // ========================================

        let mainRadarChart = null;

        function initializeApp() {
            try {
                mainRadarChart = renderMainRadarChart();
                renderIntegratedAnalysis();
            } catch (error) {
                console.error('ì•± ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
            }
        }

        window.addEventListener('load', initializeApp);
    </script>

    <footer class="py-8 mt-10 text-center border-t border-gray-200">
        <div class="flex justify-center items-center relative max-w-3xl mx-auto px-4">
            <p class="text-sm text-gray-500 flex-1 text-center">
                Copyright &copy; <span id="current-year"></span>
                <span class="font-bold text-gray-700">DeepMirror</span>.
                All rights reserved.
            </p>
            <a href="https://github.com/OLLAGANDA/deepmirror"
               target="_blank"
               aria-label="GitHub Repository"
               class="text-gray-400 hover:text-gray-900 transition-transform hover:scale-110 absolute right-4">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path>
                </svg>
            </a>
        </div>

        <p class="mt-2 text-[10px] text-gray-400">
            Based on <a href="https://ipip.ori.org/" target="_blank" class="hover:underline">IPIP-120</a> inventory.
            Inspired by <a href="https://github.com/rubynor/bigfive-web" target="_blank" class="hover:underline">rubynor/bigfive-web</a> (MIT License).
            <a href="https://www.flaticon.com/free-icons/mirror" title="mirror icons">Mirror icons created by MYS Design - Flaticon</a>
        </p>

        <div class="mt-2 text-xs text-gray-400">
            <a href="/" class="hover:text-gray-600">í™ˆìœ¼ë¡œ</a>
        </div>
    </footer>

    <script>
        // í˜„ì¬ ì—°ë„ í‘œì‹œ
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>
</body>
</html>
