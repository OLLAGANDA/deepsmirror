<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶„ì„ ê²°ê³¼ - DeepMirror</title>

    <!-- Open Graph ë©”íƒ€ íƒœê·¸ -->
    <meta property="og:type" content="website">
    <meta property="og:title" th:content="'DeepMirror: ' + ${result.nickname} + 'ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼'">
    <meta property="og:description" content="ë‚˜ì˜ ì„±ê²© ìœ í˜•ê³¼ ìƒì„¸ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/6366f1/ffffff?text=DeepMirror+Result">
    <meta property="og:url" th:content="'http://localhost:8080/results/' + ${result.id}">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen py-8 px-4">
    <div class="max-w-6xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-2xl p-8 mb-6">
            <div class="text-center">
                <div class="inline-block bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full p-3 mb-4">
                    <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
                <h1 class="text-4xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2" th:text="${result.nickname} + 'ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼'">
                    000ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼
                </h1>
                <p class="text-sm text-gray-500 mt-2" th:text="${#temporals.format(result.createdAt, 'yyyyë…„ MMì›” ddì¼ HH:mm:ss')}">ë¶„ì„ ì™„ë£Œ ì¼ì‹œ</p>
            </div>
        </div>

        <!-- Main Content: Chart + AI Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Radar Chart Card -->
            <div class="bg-white rounded-2xl shadow-2xl p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ì„±ê²© íŠ¹ì„± ë¶„í¬</h2>
                <div class="relative" style="height: 400px;">
                    <canvas id="personalityRadarChart"></canvas>
                </div>

                <!-- Legend with scores -->
                <div class="mt-6 space-y-3">
                    <div class="flex justify-between items-center px-4 py-2 bg-indigo-50 rounded-lg">
                        <span class="text-sm font-semibold text-indigo-700">ê°œë°©ì„±</span>
                        <span class="text-lg font-bold text-indigo-600" th:text="${result.openness} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-blue-50 rounded-lg">
                        <span class="text-sm font-semibold text-blue-700">ì„±ì‹¤ì„±</span>
                        <span class="text-lg font-bold text-blue-600" th:text="${result.conscientiousness} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-purple-50 rounded-lg">
                        <span class="text-sm font-semibold text-purple-700">ì™¸í–¥ì„±</span>
                        <span class="text-lg font-bold text-purple-600" th:text="${result.extraversion} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-pink-50 rounded-lg">
                        <span class="text-sm font-semibold text-pink-700">ì¹œí™”ì„±</span>
                        <span class="text-lg font-bold text-pink-600" th:text="${result.agreeableness} + 'ì '">0ì </span>
                    </div>
                    <div class="flex justify-between items-center px-4 py-2 bg-violet-50 rounded-lg">
                        <span class="text-sm font-semibold text-violet-700">ì‹ ê²½ì„±</span>
                        <span class="text-lg font-bold text-violet-600" th:text="${result.neuroticism} + 'ì '">0ì </span>
                    </div>
                </div>
            </div>

            <!-- AI Analysis Card -->
            <div class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-2xl p-8 text-white">
                <h2 class="text-2xl font-bold mb-4 flex items-center">
                    <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                    AI ì„±ê²© ë¶„ì„
                </h2>
                <div class="bg-white bg-opacity-20 backdrop-blur-lg rounded-xl p-6 overflow-y-auto" style="max-height: 550px;">
                    <p class="text-base leading-relaxed whitespace-pre-wrap" th:text="${result.aiAnalysis}">
                        AIê°€ ë¶„ì„í•œ ë‹¹ì‹ ì˜ ì„±ê²©ì— ëŒ€í•œ ìƒì„¸í•œ ì„¤ëª…ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>

        <!-- Integrated Personality Analysis Section -->
        <div class="mb-6">
            <div class="bg-white rounded-2xl shadow-2xl p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-3 text-center">í†µí•© ì„±ê²© ë¶„ì„</h2>
                <p class="text-center text-gray-600 mb-8">ê° ì„±ê²© íŠ¹ì„±ì˜ ì„¸ë¶€ ì ìˆ˜ì™€ ì†Œë¶„ë¥˜ ì°¨íŠ¸ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>

                <!-- Integrated Cards Container -->
                <div id="integratedAnalysisContainer" class="space-y-8">
                    <!-- Cards will be dynamically generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="bg-white rounded-2xl shadow-2xl p-6 mb-6">
            <div class="flex flex-col sm:flex-row gap-4">
                <a href="/"
                   class="flex-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-xl transition duration-200 transform hover:scale-105 shadow-lg text-center">
                    ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°
                </a>
                <button onclick="window.print()"
                        class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-4 px-6 rounded-xl transition duration-200 transform hover:scale-105 shadow-lg">
                    ê²°ê³¼ ì¸ì‡„
                </button>
            </div>
        </div>

        <!-- Share Button -->
        <div class="bg-white rounded-2xl shadow-2xl p-6 mb-6">
            <button onclick="shareResult()"
                    class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-5 px-6 rounded-xl transition duration-200 transform hover:scale-105 shadow-lg flex items-center justify-center gap-3">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                </svg>
                <span class="text-lg">ê²°ê³¼ ê³µìœ í•˜ê¸° ğŸ“¤</span>
            </button>
        </div>

        <!-- Toast Message (Hidden by default) -->
        <div id="toast" class="fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-6 py-4 rounded-xl shadow-2xl opacity-0 transition-opacity duration-300 pointer-events-none z-50">
            <div class="flex items-center gap-3">
                <svg class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                <span class="font-semibold">ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤</span>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        // Web Share API ê³µìœ  í•¨ìˆ˜
        async function shareResult() {
            const shareData = {
                title: 'DeepMirror: ' + /*[[${result.nickname}]]*/ 'ì‚¬ìš©ì' + 'ë‹˜ì˜ ì„±ê²© ë¶„ì„ ê²°ê³¼',
                text: 'ë‚˜ì˜ ì„±ê²© ìœ í˜•ê³¼ ìƒì„¸ ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!',
                url: window.location.href
            };

            try {
                // Web Share API ì§€ì› í™•ì¸ (ì£¼ë¡œ ëª¨ë°”ì¼)
                if (navigator.share) {
                    await navigator.share(shareData);
                } else {
                    // Fallback: í´ë¦½ë³´ë“œì— ë§í¬ ë³µì‚¬ (PC)
                    await navigator.clipboard.writeText(window.location.href);
                    showToast();
                }
            } catch (error) {
                // ì‚¬ìš©ìê°€ ê³µìœ  ì·¨ì†Œí•˜ê±°ë‚˜ ì—ëŸ¬ ë°œìƒ ì‹œ
                if (error.name !== 'AbortError') {
                    console.error('ê³µìœ  ì‹¤íŒ¨:', error);
                    // Fallback: í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹œë„
                    try {
                        await navigator.clipboard.writeText(window.location.href);
                        showToast();
                    } catch (clipboardError) {
                        console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', clipboardError);
                    }
                }
            }
        }

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        function showToast() {
            const toast = document.getElementById('toast');
            toast.style.opacity = '1';
            toast.style.pointerEvents = 'auto';

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.pointerEvents = 'none';
            }, 3000);
        }

        // Thymeleaf ë³€ìˆ˜ë¥¼ JavaScript ë³€ìˆ˜ë¡œ ë³€í™˜
        const openness = /*[[${result.openness}]]*/ 0;
        const conscientiousness = /*[[${result.conscientiousness}]]*/ 0;
        const extraversion = /*[[${result.extraversion}]]*/ 0;
        const agreeableness = /*[[${result.agreeableness}]]*/ 0;
        const neuroticism = /*[[${result.neuroticism}]]*/ 0;

        // detailMapì„ Thymeleaf ì¸ë¼ì¸ìœ¼ë¡œ ë°›ê¸°
        const detailScores = /*[[${detailMap}]]*/ {};

        // Facet ëª…ì¹­ ë§¤í•‘ (í•œê¸€)
        const facetNames = {
            'N': ['ë¶ˆì•ˆ', 'ë¶„ë…¸', 'ìš°ìš¸', 'ìì˜ì‹', 'ì¶©ë™ì„±', 'ì·¨ì•½ì„±'],
            'E': ['ì¹œë°€ê°', 'ì‚¬êµì„±', 'ë¦¬ë”ì‹­', 'í™œë™ì„±', 'ìê·¹ì¶”êµ¬', 'ê¸ì •ì •ì„œ'],
            'O': ['ìƒìƒë ¥', 'ì˜ˆìˆ ì ê°ìˆ˜ì„±', 'ê°ì„±', 'ëª¨í—˜ì„±', 'ì§€ì í˜¸ê¸°ì‹¬', 'ê°€ì¹˜ê´€'],
            'A': ['ì‹ ë¢°', 'ë„ë•ì„±', 'ì´íƒ€ì£¼ì˜', 'í˜‘ë ¥', 'ê²¸ì†', 'ê³µê°'],
            'C': ['ìê¸°íš¨ëŠ¥ê°', 'ì§ˆì„œ', 'ì˜ë¬´ê°', 'ì„±ì·¨ì§€í–¥', 'ì ˆì œ', 'ì‹ ì¤‘í•¨']
        };

        // ì„±ê²© íŠ¹ì„±ë³„ ìƒì„¸ í•´ì„ ë°ì´í„°
        const traitDescriptions = {
            openness: {
                name: 'ê°œë°©ì„±',
                nameEn: 'Openness',
                subtitle: 'ìƒˆë¡œìš´ ê²½í—˜ê³¼ ì•„ì´ë””ì–´ì— ëŒ€í•œ ê°œë°©ì„±',
                high: 'ë‹¹ì‹ ì€ ìƒìƒë ¥ì´ í’ë¶€í•˜ê³  í˜¸ê¸°ì‹¬ì´ ë§ìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ê²½í—˜ê³¼ ì•„ì´ë””ì–´ë¥¼ ì ê·¹ì ìœ¼ë¡œ íƒêµ¬í•˜ë©°, ì˜ˆìˆ ì ì´ê³  ì°½ì˜ì ì¸ í™œë™ì„ ì¦ê¹ë‹ˆë‹¤. ê´€ìŠµì— ì–½ë§¤ì´ì§€ ì•Šê³  ë…ì°½ì ì¸ ì‚¬ê³ ë¥¼ ì„ í˜¸í•˜ë©°, ë³€í™”ì™€ ë‹¤ì–‘ì„±ì„ í™˜ì˜í•©ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ìƒˆë¡œìš´ ê²ƒì— ëŒ€í•œ í˜¸ê¸°ì‹¬ê³¼ ìµìˆ™í•œ ê²ƒì— ëŒ€í•œ ì„ í˜¸ ì‚¬ì´ì—ì„œ ê· í˜•ì„ ìœ ì§€í•©ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ ì°½ì˜ì ì¸ ì ‘ê·¼ì„ ì‹œë„í•˜ê¸°ë„ í•˜ê³ , ê²€ì¦ëœ ë°©ë²•ì„ ë”°ë¥´ê¸°ë„ í•©ë‹ˆë‹¤. ì ì ˆí•œ ìˆ˜ì¤€ì˜ ë³€í™”ë¥¼ ë°›ì•„ë“¤ì´ëŠ” í¸ì…ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ìµìˆ™í•˜ê³  ê²€ì¦ëœ ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì „í†µì ì´ê³  ì‹¤ìš©ì ì¸ ì ‘ê·¼ ë°©ì‹ì„ ì„ í˜¸í•˜ë©°, ê¸‰ê²©í•œ ë³€í™”ë³´ë‹¤ëŠ” ì•ˆì •ì„±ì„ ì¤‘ìš”í•˜ê²Œ ì—¬ê¹ë‹ˆë‹¤. êµ¬ì²´ì ì´ê³  í˜„ì‹¤ì ì¸ ê²ƒì— ë” ê´€ì‹¬ì´ ë§ìœ¼ë©°, ì˜ˆì¸¡ ê°€ëŠ¥í•œ í™˜ê²½ì„ í¸ì•ˆí•˜ê²Œ ëŠë‚ë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-indigo-50 to-indigo-100',
                    border: 'border-indigo-200',
                    titleText: 'text-indigo-700',
                    badgeBg: 'bg-indigo-100',
                    badgeText: 'text-indigo-800',
                    progressBar: 'bg-gradient-to-r from-indigo-400 to-indigo-600',
                    chartBg: 'rgba(99, 102, 241, 0.2)',
                    chartBorder: 'rgba(99, 102, 241, 1)',
                    chartPoint: 'rgba(99, 102, 241, 1)',
                    chartGrid: 'rgba(99, 102, 241, 0.2)',
                    chartTooltip: 'rgba(99, 102, 241, 0.9)'
                },
                facetKey: 'O'
            },
            conscientiousness: {
                name: 'ì„±ì‹¤ì„±',
                nameEn: 'Conscientiousness',
                subtitle: 'ì±…ì„ê°ê³¼ ì¡°ì§í™” ëŠ¥ë ¥',
                high: 'ë‹¹ì‹ ì€ ë§¤ìš° ì²´ê³„ì ì´ê³  ì±…ì„ê°ì´ ê°•í•©ë‹ˆë‹¤. ê³„íšì„ ì„¸ìš°ê³  ëª©í‘œë¥¼ í–¥í•´ ê¾¸ì¤€íˆ ë…¸ë ¥í•˜ë©°, ì„¸ë¶€ì‚¬í•­ì— ì£¼ì˜ë¥¼ ê¸°ìš¸ì…ë‹ˆë‹¤. ì‹œê°„ ê´€ë¦¬ë¥¼ ì˜í•˜ê³  ì•½ì†ì„ ì¤‘ìš”í•˜ê²Œ ì—¬ê¸°ë©°, ì¼ì„ ì™„ë²½í•˜ê²Œ ë§ˆë¬´ë¦¬í•˜ë ¤ê³  ë…¸ë ¥í•©ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ìƒí™©ì— ë”°ë¼ ì²´ê³„ì ìœ¼ë¡œ ì¼í•˜ê¸°ë„ í•˜ê³  ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•˜ê¸°ë„ í•©ë‹ˆë‹¤. ì¤‘ìš”í•œ ì¼ì—ëŠ” ê³„íšì ìœ¼ë¡œ ì ‘ê·¼í•˜ì§€ë§Œ, ë•Œë¡œëŠ” ì¦‰í¥ì ì¸ ë©´ëª¨ë„ ë³´ì…ë‹ˆë‹¤. ì±…ì„ê°ê³¼ ììœ ë¡œì›€ ì‚¬ì´ì—ì„œ ê· í˜•ì„ ì°¾ìœ¼ë ¤ í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ìë°œì ì´ê³  ìœ ì—°í•œ í¸ì…ë‹ˆë‹¤. ì—„ê²©í•œ ê³„íšë³´ë‹¤ëŠ” ìƒí™©ì— ë”°ë¼ ì¦‰í¥ì ìœ¼ë¡œ ëŒ€ì‘í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ìœµí†µì„± ìˆê²Œ ì¼ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ììœ ë¡œìš´ í™˜ê²½ì—ì„œ ë” í¸ì•ˆí•¨ì„ ëŠë¼ë©°, ì§€ë‚˜ì¹œ ê·œì¹™ì´ë‚˜ ì ˆì°¨ë¥¼ ë¶€ë‹´ìŠ¤ëŸ¬ì›Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-blue-50 to-blue-100',
                    border: 'border-blue-200',
                    titleText: 'text-blue-700',
                    badgeBg: 'bg-blue-100',
                    badgeText: 'text-blue-800',
                    progressBar: 'bg-gradient-to-r from-blue-400 to-blue-600',
                    chartBg: 'rgba(59, 130, 246, 0.2)',
                    chartBorder: 'rgba(59, 130, 246, 1)',
                    chartPoint: 'rgba(59, 130, 246, 1)',
                    chartGrid: 'rgba(59, 130, 246, 0.2)',
                    chartTooltip: 'rgba(59, 130, 246, 0.9)'
                },
                facetKey: 'C'
            },
            extraversion: {
                name: 'ì™¸í–¥ì„±',
                nameEn: 'Extraversion',
                subtitle: 'ì‚¬íšŒì  ìƒí˜¸ì‘ìš©ê³¼ ì—ë„ˆì§€',
                high: 'ë‹¹ì‹ ì€ í™œë°œí•˜ê³  ì‚¬êµì ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ìˆì„ ë•Œ ì—ë„ˆì§€ë¥¼ ì–»ìœ¼ë©°, ì£¼ëª©ë°›ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ ëŒ€í™”ì— ì°¸ì—¬í•˜ê³ , ìƒˆë¡œìš´ ì‚¬ëŒë“¤ì„ ë§Œë‚˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì—´ì •ì ì´ê³  ë‚™ê´€ì ì¸ íƒœë„ë¡œ ì£¼ë³€ì„ ë°ê²Œ ë§Œë“­ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ì‚¬íšŒì  ìƒí™©ê³¼ í˜¼ìë§Œì˜ ì‹œê°„ ëª¨ë‘ë¥¼ ì¦ê¹ë‹ˆë‹¤. ë•Œë¡œëŠ” ì‚¬êµì ì´ê³  í™œë°œí•˜ì§€ë§Œ, í˜¼ì ìˆëŠ” ì‹œê°„ë„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ ì™¸í–¥ì ì´ê±°ë‚˜ ë‚´í–¥ì ì¸ ë©´ëª¨ë¥¼ ë³´ì´ë©°, ë‹¤ì–‘í•œ í™˜ê²½ì— ì˜ ì ì‘í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ì¡°ìš©í•˜ê³  ì‚¬ë ¤ ê¹Šì€ í¸ì…ë‹ˆë‹¤. í˜¼ìë§Œì˜ ì‹œê°„ì´ë‚˜ ì†Œìˆ˜ì˜ ì¹œí•œ ì‚¬ëŒë“¤ê³¼ ë³´ë‚´ëŠ” ì‹œê°„ì„ ì„ í˜¸í•˜ë©°, ê¹Šì´ ìˆëŠ” ëŒ€í™”ë¥¼ ì¢‹ì•„í•©ë‹ˆë‹¤. í° ëª¨ì„ë³´ë‹¤ëŠ” ì¡°ìš©í•œ í™˜ê²½ì„ í¸ì•ˆí•˜ê²Œ ëŠë¼ë©°, ì‹ ì¤‘í•˜ê²Œ ìƒê°í•œ í›„ í–‰ë™í•©ë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-purple-50 to-purple-100',
                    border: 'border-purple-200',
                    titleText: 'text-purple-700',
                    badgeBg: 'bg-purple-100',
                    badgeText: 'text-purple-800',
                    progressBar: 'bg-gradient-to-r from-purple-400 to-purple-600',
                    chartBg: 'rgba(168, 85, 247, 0.2)',
                    chartBorder: 'rgba(168, 85, 247, 1)',
                    chartPoint: 'rgba(168, 85, 247, 1)',
                    chartGrid: 'rgba(168, 85, 247, 0.2)',
                    chartTooltip: 'rgba(168, 85, 247, 0.9)'
                },
                facetKey: 'E'
            },
            agreeableness: {
                name: 'ì¹œí™”ì„±',
                nameEn: 'Agreeableness',
                subtitle: 'íƒ€ì¸ì— ëŒ€í•œ ê³µê°ê³¼ í˜‘ë ¥',
                high: 'ë‹¹ì‹ ì€ ë”°ëœ»í•˜ê³  ì¹œì ˆí•˜ë©° í˜‘ì¡°ì ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì— ê³µê°ì„ ì˜í•˜ê³ , íƒ€ì¸ì„ ë„ìš°ë ¤ëŠ” ë§ˆìŒì´ ê°•í•©ë‹ˆë‹¤. ê°ˆë“±ì„ í”¼í•˜ê³  ì¡°í™”ë¥¼ ì¶”êµ¬í•˜ë©°, íƒ€ì¸ì˜ ê´€ì ì„ ì´í•´í•˜ê³  ì¡´ì¤‘í•©ë‹ˆë‹¤. ê´€ëŒ€í•˜ê³  ë„ˆê·¸ëŸ¬ìš´ ì„±ê²©ì…ë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ í˜‘ì¡°ì ì´ë©´ì„œë„ ìì‹ ì˜ ì˜ê²¬ì„ í‘œí˜„í•  ì¤„ ì••ë‹ˆë‹¤. íƒ€ì¸ì„ ë°°ë ¤í•˜ì§€ë§Œ í•„ìš”í•  ë•ŒëŠ” ë‹¨í˜¸í•˜ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³µê°ê³¼ ê°ê´€ì„± ì‚¬ì´ì—ì„œ ê· í˜•ì„ ìœ ì§€í•˜ë©°, ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ë…ë¦½ì ì´ê³  ê²½ìŸì ì…ë‹ˆë‹¤. ê°ê´€ì ì´ê³  ë…¼ë¦¬ì ì¸ ì ‘ê·¼ì„ ì„ í˜¸í•˜ë©°, ìì‹ ì˜ ì˜ê²¬ì„ ì†”ì§í•˜ê²Œ í‘œí˜„í•©ë‹ˆë‹¤. ë•Œë¡œëŠ” íƒ€ì¸ì˜ ê°ì •ë³´ë‹¤ ì‚¬ì‹¤ê³¼ íš¨ìœ¨ì„±ì„ ìš°ì„ ì‹œí•˜ë©°, í•„ìš”í•  ë•ŒëŠ” ê°ˆë“±ì„ ë§ˆë‹¤í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-pink-50 to-pink-100',
                    border: 'border-pink-200',
                    titleText: 'text-pink-700',
                    badgeBg: 'bg-pink-100',
                    badgeText: 'text-pink-800',
                    progressBar: 'bg-gradient-to-r from-pink-400 to-pink-600',
                    chartBg: 'rgba(236, 72, 153, 0.2)',
                    chartBorder: 'rgba(236, 72, 153, 1)',
                    chartPoint: 'rgba(236, 72, 153, 1)',
                    chartGrid: 'rgba(236, 72, 153, 0.2)',
                    chartTooltip: 'rgba(236, 72, 153, 0.9)'
                },
                facetKey: 'A'
            },
            neuroticism: {
                name: 'ì‹ ê²½ì„±',
                nameEn: 'Neuroticism',
                subtitle: 'ì •ì„œì  ì•ˆì •ì„±ê³¼ ìŠ¤íŠ¸ë ˆìŠ¤ ëŒ€ì²˜',
                high: 'ë‹¹ì‹ ì€ ê°ì •ì´ í’ë¶€í•˜ê³  ì„¬ì„¸í•©ë‹ˆë‹¤. ìŠ¤íŠ¸ë ˆìŠ¤ë‚˜ ê±±ì •ì„ ìì£¼ ê²½í—˜í•  ìˆ˜ ìˆìœ¼ë©°, ê°ì • ë³€í™”ê°€ í¬ê³  ë¯¼ê°í•œ í¸ì…ë‹ˆë‹¤. ì–´ë ¤ìš´ ìƒí™©ì—ì„œ ë¶ˆì•ˆì´ë‚˜ ê¸´ì¥ì„ ëŠë¼ê¸° ì‰½ì§€ë§Œ, ì´ëŠ” ì‹ ì¤‘í•˜ê³  ì„¸ì‹¬í•œ ì ‘ê·¼ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                middle: 'ë‹¹ì‹ ì€ ì •ì„œì ìœ¼ë¡œ ì•ˆì •ì ì´ë©´ì„œë„ ë•Œë•Œë¡œ ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ëŠë‚ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ìƒí™©ì—ì„œ ì¹¨ì°©í•˜ê²Œ ëŒ€ì‘í•˜ì§€ë§Œ, ì–´ë ¤ìš´ ìƒí™©ì—ì„œëŠ” ë¶ˆì•ˆì„ ê²½í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ì •ê³¼ ì´ì„± ì‚¬ì´ì—ì„œ ê· í˜•ì„ ìœ ì§€í•˜ë ¤ ë…¸ë ¥í•©ë‹ˆë‹¤.',
                low: 'ë‹¹ì‹ ì€ ì •ì„œì ìœ¼ë¡œ ë§¤ìš° ì•ˆì •ì ì…ë‹ˆë‹¤. ìŠ¤íŠ¸ë ˆìŠ¤ ìƒí™©ì—ì„œë„ ì¹¨ì°©í•¨ì„ ìœ ì§€í•˜ë©°, ê°ì •ì ìœ¼ë¡œ í”ë“¤ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. ì°¨ë¶„í•˜ê³  í‰ì˜¨í•œ ìƒíƒœë¥¼ ìœ ì§€í•˜ë©°, ì–´ë ¤ìš´ ìƒí™©ì—ì„œë„ ëƒ‰ì •í•˜ê²Œ ëŒ€ì²˜í•©ë‹ˆë‹¤. ìì‹ ê° ìˆê³  íšŒë³µíƒ„ë ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.',
                colors: {
                    cardBg: 'bg-gradient-to-br from-violet-50 to-violet-100',
                    border: 'border-violet-200',
                    titleText: 'text-violet-700',
                    badgeBg: 'bg-violet-100',
                    badgeText: 'text-violet-800',
                    progressBar: 'bg-gradient-to-r from-violet-400 to-violet-600',
                    chartBg: 'rgba(139, 92, 246, 0.2)',
                    chartBorder: 'rgba(139, 92, 246, 1)',
                    chartPoint: 'rgba(139, 92, 246, 1)',
                    chartGrid: 'rgba(139, 92, 246, 0.2)',
                    chartTooltip: 'rgba(139, 92, 246, 0.9)'
                },
                facetKey: 'N'
            }
        };

        // ì ìˆ˜ì— ë”°ë¥¸ ë ˆë²¨ íŒì •
        function getLevel(score) {
            if (score >= 67) return 'high';
            if (score >= 34) return 'middle';
            return 'low';
        }

        // ë ˆë²¨ì— ë”°ë¥¸ ë±ƒì§€ í…ìŠ¤íŠ¸
        function getLevelBadge(score) {
            if (score >= 67) return 'ë†’ìŒ';
            if (score >= 34) return 'ë³´í†µ';
            return 'ë‚®ìŒ';
        }

        // ë ˆë²¨ì— ë”°ë¥¸ ë±ƒì§€ ìƒ‰ìƒ
        function getLevelBadgeColor(score) {
            if (score >= 67) return 'bg-green-100 text-green-800';
            if (score >= 34) return 'bg-yellow-100 text-yellow-800';
            return 'bg-gray-100 text-gray-800';
        }

        // Facet ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function getFacetData(facetKey) {
            return [
                detailScores[facetKey + '1'] || 0,
                detailScores[facetKey + '2'] || 0,
                detailScores[facetKey + '3'] || 0,
                detailScores[facetKey + '4'] || 0,
                detailScores[facetKey + '5'] || 0,
                detailScores[facetKey + '6'] || 0
            ];
        }

        // Facet ì°¨íŠ¸ ìƒì„± (í†µí•© ì¹´ë“œìš©)
        function createIntegratedFacetChart(canvasId, facetKey, colors) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const facetData = getFacetData(facetKey);
            const labels = facetNames[facetKey];

            return new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì†Œë¶„ë¥˜ ì ìˆ˜',
                        data: facetData,
                        backgroundColor: colors.chartBg,
                        borderColor: colors.chartBorder,
                        borderWidth: 2,
                        pointBackgroundColor: colors.chartPoint,
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: colors.chartPoint,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            min: 0,
                            max: 100,
                            beginAtZero: true,
                            ticks: {
                                stepSize: 20,
                                font: {
                                    size: 10
                                },
                                backdropColor: 'rgba(255, 255, 255, 0.8)'
                            },
                            pointLabels: {
                                font: {
                                    size: 11,
                                    weight: 'bold'
                                },
                                color: '#4B5563',
                                padding: 8
                            },
                            grid: {
                                color: colors.chartGrid
                            },
                            angleLines: {
                                color: colors.chartGrid
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: colors.chartTooltip,
                            padding: 10,
                            titleFont: {
                                size: 12,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 11
                            },
                            callbacks: {
                                label: function(context) {
                                    return ' ' + context.parsed.r + 'ì ';
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1200,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // í†µí•© ë¶„ì„ ì¹´ë“œ ìƒì„±
        function renderIntegratedAnalysis() {
            const traits = [
                { key: 'openness', score: openness },
                { key: 'conscientiousness', score: conscientiousness },
                { key: 'extraversion', score: extraversion },
                { key: 'agreeableness', score: agreeableness },
                { key: 'neuroticism', score: neuroticism }
            ];

            const container = document.getElementById('integratedAnalysisContainer');

            traits.forEach((trait, index) => {
                const data = traitDescriptions[trait.key];
                const level = getLevel(trait.score);
                const description = data[level];
                const colors = data.colors;
                const canvasId = `facetChart_${trait.key}`;

                const card = document.createElement('div');
                card.className = `${colors.cardBg} border-2 ${colors.border} rounded-2xl shadow-xl overflow-hidden`;

                card.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-8">
                        <!-- ì¢Œì¸¡: Facet ì°¨íŠ¸ ì˜ì—­ -->
                        <div class="flex flex-col justify-center">
                            <h3 class="${colors.titleText} text-2xl font-bold mb-2 text-center">${data.name}</h3>
                            <p class="text-sm text-gray-600 mb-4 text-center">${data.nameEn}</p>
                            <div class="relative bg-white rounded-xl p-4 shadow-inner" style="max-height: 320px; height: 320px;">
                                <canvas id="${canvasId}"></canvas>
                            </div>
                        </div>

                        <!-- ìš°ì¸¡: ì„¸ë¶€ ì •ë³´ ì˜ì—­ -->
                        <div class="flex flex-col justify-center">
                            <div class="mb-6">
                                <div class="flex justify-between items-center mb-3">
                                    <div>
                                        <h4 class="${colors.titleText} text-xl font-bold">${data.subtitle}</h4>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="${getLevelBadgeColor(trait.score)} px-3 py-1 rounded-full text-xs font-semibold">
                                            ${getLevelBadge(trait.score)}
                                        </span>
                                        <span class="${colors.titleText} text-4xl font-bold">${trait.score}</span>
                                    </div>
                                </div>

                                <!-- Progress Bar -->
                                <div class="w-full bg-white bg-opacity-60 rounded-full h-4 overflow-hidden shadow-inner mb-4">
                                    <div class="${colors.progressBar} h-4 rounded-full transition-all duration-1000 ease-out shadow-md"
                                         style="width: 0%"
                                         data-width="${trait.score}%">
                                    </div>
                                </div>
                            </div>

                            <!-- ìƒì„¸ ì„¤ëª… -->
                            <div class="bg-white bg-opacity-50 rounded-xl p-5 shadow-sm">
                                <p class="text-gray-800 leading-relaxed text-sm">
                                    ${description}
                                </p>
                            </div>
                        </div>
                    </div>
                `;

                container.appendChild(card);

                // ì°¨íŠ¸ ë Œë”ë§
                setTimeout(() => {
                    createIntegratedFacetChart(canvasId, data.facetKey, colors);
                }, 50);
            });

            // Progress bar ì• ë‹ˆë©”ì´ì…˜
            setTimeout(() => {
                document.querySelectorAll('[data-width]').forEach(bar => {
                    bar.style.width = bar.getAttribute('data-width');
                });
            }, 100);
        }

        // ë©”ì¸ Radar Chart ì„¤ì •
        const ctx = document.getElementById('personalityRadarChart').getContext('2d');
        const radarChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['ê°œë°©ì„±', 'ì„±ì‹¤ì„±', 'ì™¸í–¥ì„±', 'ì¹œí™”ì„±', 'ì‹ ê²½ì„±'],
                datasets: [{
                    label: 'ì„±ê²© íŠ¹ì„± ì ìˆ˜',
                    data: [openness, conscientiousness, extraversion, agreeableness, neuroticism],
                    backgroundColor: 'rgba(99, 102, 241, 0.3)',
                    borderColor: 'rgba(99, 102, 241, 1)',
                    borderWidth: 3,
                    pointBackgroundColor: 'rgba(139, 92, 246, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(139, 92, 246, 1)',
                    pointRadius: 5,
                    pointHoverRadius: 7
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        min: 0,
                        max: 100,
                        beginAtZero: true,
                        ticks: {
                            stepSize: 20,
                            font: {
                                size: 12
                            },
                            backdropColor: 'rgba(255, 255, 255, 0.8)'
                        },
                        pointLabels: {
                            font: {
                                size: 14,
                                weight: 'bold'
                            },
                            color: '#4B5563'
                        },
                        grid: {
                            color: 'rgba(99, 102, 241, 0.2)'
                        },
                        angleLines: {
                            color: 'rgba(99, 102, 241, 0.2)'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(99, 102, 241, 0.9)',
                        padding: 12,
                        titleFont: {
                            size: 14,
                            weight: 'bold'
                        },
                        bodyFont: {
                            size: 13
                        },
                        callbacks: {
                            label: function(context) {
                                return ' ' + context.parsed.r + 'ì ';
                            }
                        }
                    }
                },
                animation: {
                    duration: 1500,
                    easing: 'easeInOutQuart'
                }
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('load', () => {
            radarChart.update();
            renderIntegratedAnalysis();
        });
    </script>
</body>
</html>
